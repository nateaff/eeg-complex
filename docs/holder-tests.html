<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Nathanael Aff" />


<title>Properties of the Complexity Coefficients</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">eeg-complex</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
<li>
  <a href="sim-examples.html">Simulations</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nateaff/eeg-complex">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Properties of the Complexity Coefficients</h1>
<h4 class="author"><em>Nathanael Aff</em></h4>
<h4 class="date"><em>2017–07-10</em></h4>

</div>


<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
<!-- Update knitr chunk options -->
<!-- Insert the date the file was last updated -->
<p><strong>Last updated:</strong> 2017-07-22</p>
<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
<p><strong>Code version:</strong> Unavailable. Initialize Git repository to enable.</p>
<pre class="r"><code>  devtools::load_all()
  knitr::read_chunk(&quot;../code/holder-weierstrass-notrandom.R&quot;)</code></pre>
<p>Darkhovsky and Piryatinska have conjectured that for a constant generating process the complexity coefficients are constant. More concretely, we tested if, for a constant Hölder class of functions the complexity coefficients are also constant.</p>
<p>The Weierstrass function is well-known function that is continuous but nowhere differentiable. The function can be written: <span class="math display">\[
 W_{\alpha}(x) = \sum_{n=0}^{\infty}b^{-n\alpha}\cos(b^n \pi x).
\]</span> In this form, the single parameter <span class="math inline">\(\alpha\)</span> is the Hölder class for the function and <span class="math inline">\(2-\alpha\)</span> is the functions fractal dimension<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. A plot of the Weierstrass function for several parameters is shown below.</p>
<pre class="r"><code># Weierstrass function without random phase
library(dplyr)

prefix = &quot;holder_notrandom&quot;
len = 1000
from_cache = TRUE
set.seed(seed)
alpha &lt;- seq(0.1, 0.99, length.out = 20)
reps = 1
if(from_cache) {
  xs     &lt;- readRDS(cache_file(&quot;weierstrass_xs&quot;, prefix)) 
  emeans &lt;- readRDS(cache_file(&quot;weierstrass_ecomp&quot;, prefix))
  emc    &lt;- readRDS(cache_file(&quot;weierstrass_emc&quot;, prefix))
  fdmc    &lt;- readRDS(cache_file(&quot;weierstrass_fdmc&quot;, prefix))
  fdmeans    &lt;- readRDS(cache_file(&quot;weierstrass_fdmean&quot;, prefix))

} else {
  # generate set of weierstrass functions for each alpha
  ws &lt;- lapply(alpha, function(x) tssims::weierstrass(a = x, random = FALSE))
  xs &lt;- replicate(reps, sapply(ws, function(w) tssims::gen(w)(1000)))
  xs &lt;- xs[3:997, , ]
  # takes 3 dimensional array, with the third dimension the parameter
  ecomp &lt;-  apply(xs, 2, ecomp_cspline)
  fd &lt;- apply(xs, 2, fd_variogram)
  emeans &lt;- lapply(ecomp, function(x) data.frame(A = x$A, B = x$B)) %&gt;% 
            do.call(rbind, .)
  fdmeans &lt;- lapply(fd, function(x) data.frame(fd = x$fd)) %&gt;% 
            do.call(rbind, .)

  emeans$alpha &lt;- alpha
  names(emeans) &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;alpha&quot;)
  save_cache(xs, &quot;weierstrass_xs&quot;, prefix)
  save_cache(emeans, &quot;weierstrass_ecomp&quot;, prefix)
  save_cache(emc, &quot;weierstrass_emc&quot;, prefix)
  save_cache(fdmeans, &quot;weierstrass_fdmean&quot;, prefix)
  save_cache(fdmc, &quot;weierstrass_fdmc&quot;, prefix)
}

# Plot time series and boxplots of coeffcients
cols &lt;- seq(1, 19, by = 2)
cols = c(3, 8, 16)
# alpha[cols]

# Plot a single example from fbm with different parameters
plot.ts(xs[,cols], main = &quot;Weierstrass function&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/holder-tests.Rmd/holder-weir1-1.png" alt="Plot of Weierstrass function with alpha parameters (0.2, 0.42, 0.8)" width="672" />
<p class="caption">
Plot of Weierstrass function with alpha parameters (0.2, 0.42, 0.8)
</p>
</div>
<p>The complexity coefficients and fractal dimension was estimated for 20 values of <span class="math inline">\(\alpha\)</span>. The results plotted below show that the all both complexity coefficients and fractal dimension change linearly with the <span class="math inline">\(\alpha\)</span> parameter.</p>
<pre class="r"><code>  par(mfrow = c(1, 3))
  plot(alpha[1:19],  emeans[1:19, 1], 
     xlab = &quot;Alpha&quot;, 
       ylab = &quot;A&quot;, 
       cex = 1.2 
       )
  
  plot(alpha[1:19], emeans[1:19, 2], 
       xlab = &quot;Alpha&quot;, 
       ylab = &quot;B&quot;, 
       cex = 1.3 
       )
  plot(alpha[1:19], fdmeans[1:19, 1], 
       xlab = &quot;Alpha&quot;, 
       ylab = &quot;Fractal Dimension&quot;, 
       cex = 1.3, 
       )</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/holder-tests.Rmd/holder-weir2-1.png" alt="Complexity coefficients and fractal dimension plotted against the Weierstrass parameter alpha." width="672" />
<p class="caption">
Complexity coefficients and fractal dimension plotted against the Weierstrass parameter alpha.
</p>
</div>
<pre class="r"><code>  knitr::read_chunk(&quot;../code/holder-cauchy-plots.R&quot;)</code></pre>
<p>Several of the random processes plotted <a href="sim-tests.html">here</a> have parameters that determine both the Hölder class of samples paths generated by the process. For the random-Weierstrass function, fractional Brownian motion(fBm), and the Cauchy process, a single parameter determines both the Hölder class and the fractal dimension of the process.</p>
<p>Fractional Brownian motion has a single parameter that determines both the Hölder class/fractal dimension of its sample paths and the Hurst parameter. The Hurst parameter is a measure of the the long range dependence of a random process.</p>
<p>On the other hand, the Cauchy process has two parameters which isolate the fractal dimension and Hurst parameter. The Cauchy process is defined in terms of its correlation function <span class="math display">\[
   c(h) = (1 + |h|^{\alpha})^{-\beta/\alpha}, \hspace{1em} h \in \mathbb{R}.
\]</span></p>
<p>For <span class="math inline">\(\alpha \in (0, 2]\)</span> its fractal dimension is <span class="math display">\[
 D = 2 - \frac{\alpha}{2}. 
\]</span></p>
<p>And for <span class="math inline">\(\beta \in (0,1)\)</span> its Hurst parameter is <span class="math display">\[
    H = 1 - \frac{\beta}{2}.
\]</span></p>
<p>The plot below shows the Cauchy process on a 3 <span class="math inline">\(\times\)</span> 3 grid of parameters. Fractal dimension (and the Hölder class) are constant on the columns.</p>
<pre class="r"><code>  library(ecomplex)
  library(dplyr)
  library(ggplot2)
  library(ggthemes)
  
  seed = 2017
  from_cache = TRUE
  len &lt;- 150
  reps &lt;- 50
  prefix &lt;- &quot;cauchy&quot;
  set.seed(seed)
  
  alpha &lt;- seq(0.1, 1.3, length.out = 3) 
  beta &lt;- seq(0.01, .7, length.out = 3)
  
  alpha_to_fd &lt;- function(alpha) alpha + 1 - alpha/2
  beta_to_hurst &lt;- function(beta) 1 - beta/2
  
  ab &lt;- expand.grid(alpha, beta)
  fh &lt;- cbind(alpha_to_fd(ab[,1]), beta_to_hurst(ab[,2]))
  names(ab) &lt;- c(&quot;alpha&quot;, &quot;beta&quot;)
  names(fh) &lt;- c(&quot;Fractal_dim&quot;, &quot;Hurst&quot;)
  
  
  ws &lt;- apply(ab, 1, function(x) tssims::cauchy(alpha = x[1], beta = x[2]))
  xs &lt;- lapply(ws, function(w) tssims::gen(w)(len)) %&gt;% 
        do.call(cbind, .) %&gt;% 
        data.frame
  
  comps &lt;- lapply(xs, function(x) tsfeats::get_features(x, tsfeats::ecomp_cspline)) %&gt;% 
           do.call(rbind, .) %&gt;% round(., 2)
  
  
  names(xs) &lt;- paste0(&quot;Complexity &#39;B&#39;=&quot;, comps[,2], &quot; , &quot;, &quot;Hurst=&quot;, round(fh[,2], 2))
  plot_ts(xs, ncol = 3)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/holder-tests.Rmd/cauchy1-1.png" alt="Plot of Cauchy process for a grid of parameters." width="864" />
<p class="caption">
Plot of Cauchy process for a grid of parameters.
</p>
</div>
<p>30 samples were generated for each parameter combination on a 10 <span class="math inline">\(\times\)</span> 10 grid. The plots below show the estimates for the complexity coefficients and fractal dimension plotted first gainst the <span class="math inline">\(\alpha\)</span> parameter and secondly against the <span class="math inline">\(\beta\)</span> parameter. The plots show the complexity coefficient <span class="math inline">\(B\)</span> and the fractal dimension estimator change linearly with <span class="math inline">\(\alpha\)</span> but are largely unaffected by the changes in the Hurst parameter.</p>
<pre class="r"><code>  knitr::read_chunk(&quot;../code/holder-cauchy.R&quot;)</code></pre>
<pre class="r"><code>  library(ecomplex)
  library(dplyr)
  
  seed = 2017
  from_cache = TRUE
  len &lt;- 500
  reps &lt;- 30
  prefix &lt;- &quot;cauchy&quot;
  set.seed(seed)
  
  alpha &lt;- seq(0.01, 1.99, length.out = 10) 
  beta &lt;- seq(0.01, 1.5, length.out = 10)
  ab &lt;- expand.grid(alpha, beta)
  
  if(!from_cache){
    ws &lt;- apply(ab, 1, function(x) tssims::cauchy(alpha = x[1], beta = x[2]))
    xs &lt;- replicate(reps, sapply(ws, function(w) tssims::gen(w)(len)))
  
    emc &lt;- mc_features(xs, tsfeats::ecomp_cspline)
    fdmc &lt;- mc_features(xs, tsfeats::fd_variogram)
    hmc &lt;- mc_features(xs, tsfeats::hurst_pracma)
  
    save_cache(emc, &quot;ecoeff&quot;, prefix) 
    save_cache(fdmc, &quot;fd&quot;, prefix) 
    save_cache(hmc, &quot;hurst&quot;, prefix) 
    save_cache(xs, &quot;xs&quot;, prefix)
  } else{
    xs  &lt;- readRDS(cache_file(&quot;xs&quot;, prefix)) 
    emc&lt;- readRDS(cache_file(&quot;ecoeff&quot;, prefix))
    fdmc &lt;- readRDS(cache_file(&quot;fd&quot;, prefix))
    hmc &lt;- readRDS(cache_file(&quot;hurst&quot;, prefix))
  }
  
  emean &lt;- mc_stat(emc, mean)
  varmean  &lt;- mc_stat(emc, var)
  fdmean &lt;- mc_stat(fdmc, mean) 
  hmean &lt;- mc_stat(hmc, mean)
   
  cols = c(22, 25, 29)
  
  # Plot a single example from fbm with different parameters
  # pdf(file.path(getwd(), paste0(&quot;figures/&quot;, prefix, &quot;-plot.pdf&quot;)), 
      # width = 5, height = 4)
  # plot.ts(xs[, cols, 1], main = &quot;Cauchy process&quot;)
  # dev.off() 
  
  coeffA &lt;- lapply(emc, function(x) x[,1]) %&gt;% 
            do.call(cbind, .) %&gt;%
            data.frame
  
  coeffB &lt;- lapply(emc, function(x) x[,2]) %&gt;% 
            do.call(cbind, .) %&gt;%
            data.frame
  
  coeffFD &lt;- lapply(fdmc, function(x) x[,1]) %&gt;%          
             do.call(cbind, .) %&gt;%
             data.frame
  
  colnames(coeffA) &lt;- paste0(rep(round(alpha, 2), 10))
  colnames(coeffB) &lt;- paste0(rep(round(alpha, 2), 10))
  colnames(coeffFD) &lt;- paste0(rep(round(alpha, 2),10))
  
  
  
  ab_df  &lt;- cbind(emean, ab, fdmean, hmean, varmean)
  names(ab_df) &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;Alpha&quot;, &quot;Beta&quot;, &quot;fd&quot;, &quot;hurst&quot;)
  
  # pdf(file.path(getwd(), paste0(&quot;figures/&quot;, prefix, &quot;alpha-scatterplots.pdf&quot;)), 
      # width = 9, height = 4)
  par(mfrow = c(1, 3))
  with(ab_df, plot(Alpha, A,  col = &quot;gray20&quot; , cex = 1.2))
  with(ab_df, plot(Alpha, B,  col = &quot;gray20&quot; , cex = 1.2))
  with(ab_df, plot(Alpha, fd, ylab = &quot;Fractal Dimension&quot;, col = &quot;gray20&quot;, cex = 1.2))</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/holder-tests.Rmd/cauchy3-1.png" alt="Plot of complexity coefficients and fractal dimension on a grid Cauchy process sampled from a grid of parameters." width="672" />
<p class="caption">
Plot of complexity coefficients and fractal dimension on a grid Cauchy process sampled from a grid of parameters.
</p>
</div>
<pre class="r"><code>  # dev.off()
  
  
  # pdf(file.path(getwd(), paste0(&quot;figures/&quot;, prefix, &quot;beta-scatterplots.pdf&quot;)), 
  #     width = 9, height = 4)
  par(mfrow = c(1, 3))
  with(ab_df, plot(Beta, A,  col = &quot;gray20&quot;) )
  with(ab_df, plot(Beta, B,  col = &quot;gray20&quot;) )
  with(ab_df, plot(Beta, fd, ylab = &quot;Fractal Dimension&quot;,  col = &quot;gray20&quot;) )</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/holder-tests.Rmd/cauchy3-2.png" alt="Plot of complexity coefficients and fractal dimension on a grid Cauchy process sampled from a grid of parameters." width="672" />
<p class="caption">
Plot of complexity coefficients and fractal dimension on a grid Cauchy process sampled from a grid of parameters.
</p>
</div>
<pre class="r"><code>  # dev.off() </code></pre>
<p>Similar results held for fBM but not for the random Weierstrass function. In all cases, the complexity coefficient behaved similar to the fractal dimension estimator based on the empirical variogram of the function.</p>
<p>It’s likely that the complexity coefficient <span class="math inline">\(B\)</span> is an estimator of fractal dimension. One approach to proving this is would be to restrict the proof to, for example, stationary Gaussian processes.</p>
<!-- Add your analysis here -->
<div id="session-information" class="section level2">
<h2>Session information</h2>
<!-- Insert the session information into the document -->
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.4.1 (2017-06-30)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 14.04.5 LTS

Matrix products: default
BLAS: /usr/lib/libblas/libblas.so.3.0
LAPACK: /usr/lib/lapack/liblapack.so.3.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] ggthemes_3.4.0     ggplot2_2.2.1      ecomplex_0.0.1    
[4] dplyr_0.7.1        eegcomplex_0.0.0.1

loaded via a namespace (and not attached):
 [1] reshape2_1.4.1           lattice_0.20-35         
 [3] splines_3.4.1            colorspace_1.2-6        
 [5] fArma_3010.79            htmltools_0.3.6         
 [7] yaml_2.1.14              rlang_0.1.1             
 [9] pracma_2.0.7             ForeCA_0.2.4            
[11] glue_1.1.1               withr_1.0.2             
[13] sp_1.2-5                 splus2R_1.2-1           
[15] bindrcpp_0.2             plyr_1.8.4              
[17] bindr_0.1                stringr_1.2.0           
[19] timeDate_3012.100        munsell_0.4.3           
[21] fBasics_3011.87          commonmark_1.2          
[23] gtable_0.2.0             timeSeries_3022.101.2   
[25] devtools_1.13.2          gmwm_2.0.0              
[27] memoise_1.1.0            evaluate_0.10.1         
[29] labeling_0.3             knitr_1.16              
[31] highr_0.6                Rcpp_0.12.11            
[33] scales_0.4.1             backports_1.0.5         
[35] abind_1.4-3              sapa_2.0-2              
[37] fracdiff_1.4-2           digest_0.6.12           
[39] stringi_1.1.5            grid_3.4.1              
[41] rprojroot_1.2            fractaldim_0.8-4        
[43] quadprog_1.5-5           tools_3.4.1             
[45] magrittr_1.5             ifultools_2.0-4         
[47] lazyeval_0.2.0           pdc_1.0.3               
[49] tibble_1.3.3             tsfeats_0.0.0.9000      
[51] randomForest_4.6-12      pkgconfig_2.0.1         
[53] MASS_7.3-45              xml2_1.1.1              
[55] RandomFieldsUtils_0.3.25 RandomFields_3.1.50     
[57] tssims_0.0.0.9000        assertthat_0.2.0        
[59] rmarkdown_1.6            roxygen2_6.0.1          
[61] R6_2.2.2                 git2r_0.18.0            
[63] compiler_3.4.1          </code></pre>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>This was recently proved by <a href="https://arxiv.org/abs/1505.03986">Shen</a>.<a href="#fnref1">↩</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
